{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/index.js","webpack:///./src/loadFsas.js","webpack:///external \"csv-parse\"","webpack:///external \"dotenv\"","webpack:///external \"fs\"","webpack:///external \"puppeteer\""],"names":["require","config","fs","puppeteer","loadFsas","data_dir","process","env","RESULTS_DIR","CLINIC_FINDER_URL","FSA_FILE","main","fsas","browser","launch","headless","page","newPage","getData","fsa","goto","waitUntil","timeout","s","t","Promise","r","setTimeout","waitForSelector","focus","keyboard","type","press","click","data","evaluate","searchResults","Array","from","document","querySelectorAll","map","result","name","querySelector","innerText","city","address","details","href","directions","resolve","reject","writeFile","JSON","stringify","err","console","log","f","close","error","parse","module","exports","file","output","parser","delimiter","on","record","read","push","message","write","readFileSync","end"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","require('dotenv').config()\n\nconst fs = require(\"fs\");\nconst puppeteer = require(\"puppeteer\");\nconst loadFsas = require('./loadFsas')\n\nconst data_dir = process.env.RESULTS_DIR || 'data'\nconst CLINIC_FINDER_URL = \"https://clinicfinder.shoppersdrugmart.ca/\";\nconst FSA_FILE = 'src/FSA.csv'\n\nasync function main() {\n  const fsas = await loadFsas(FSA_FILE)\n\n  try {\n    const browser = await puppeteer.launch({\n      headless: false\n    });\n    const page = await browser.newPage();\n\n    async function getData(fsa) {\n      await page.goto(CLINIC_FINDER_URL, {\n        waitUntil: \"networkidle2\",\n        timeout: 3000000\n      });\n\n      let s = t => new Promise(r => setTimeout(r, t));\n\n      await page.waitForSelector(\"#search-input\");\n      await page.focus(\"#search-input\");\n      await page.keyboard.type(fsa);\n      await page.focus(\"#search-input\");\n      await page.waitForSelector(\".pac-container\");\n\n      await s(2000);\n      await page.keyboard.press(\"ArrowDown\");\n      await s(1000);\n      await page.click(\"body\");\n      await s(1000);\n      await page.focus(\"#search-button\");\n      await page.click(\"#search-button\");\n\n      await s(2000);\n\n      let data = await page.evaluate(() => {\n        let searchResults = Array.from(\n          document.querySelectorAll(\".search-result\")\n        );\n        return searchResults.map(result => {\n          let name = result.querySelector(\"label.sb.purple\").innerText;\n          let city = result.querySelector(\"label.ssb.black-font\").innerText;\n          let address = result.querySelector(\"p.sr\").innerText;\n\n          let details = result.querySelector(\n            \".row:nth-child(2) > div:last-child .col:first-child > a\"\n          ).href;\n\n          let directions = result.querySelector(\n            \".row:nth-child(2) > div:last-child .col:last-child > a\"\n          ).href;\n\n          return {\n            name,\n            city,\n            address,\n            details,\n            directions\n          };\n        });\n      });\n\n      // save data as JSON\n\n      await new Promise((resolve, reject) => {\n        fs.writeFile(`./${data_dir}/` + fsa + \"-data.json\", JSON.stringify(data, null, 2), err => {\n          if (err) {\n            reject(err);\n          } else {\n            resolve();\n            console.log(fsa + \" Done.\");\n          }\n        });\n      });\n    }\n\n    for (let f of fsas) {\n      await getData(f);\n    }\n\n    console.log(\"finished\");\n    browser.close();\n\n    // all done, close this browser\n  } catch (error) {\n    // if something went wrong display the error\n    console.log(error);\n  }\n}\n\nmain();","const fs = require('fs')\nconst parse = require('csv-parse')\n\nmodule.exports = (file) => {\n  return new Promise((resolve) => {\n    const output = []\n    // Create the parser\n    const parser = parse({\n      delimiter: '\\n'\n    })\n    // Use the readable stream api\n    parser.on('readable', function () {\n      let record\n      while (record = parser.read()) {\n        output.push(record)\n      }\n    })\n    // Catch any error\n    parser.on('error', function (err) {\n      console.error(err.message)\n    })\n    // When we are done, test that the parsed output matched what expected\n    parser.on('end', function () {\n      // console.log('end', output)\n      resolve(output)\n    })\n\n    parser.write(fs.readFileSync(file))\n    parser.end()\n  })\n}","module.exports = require(\"csv-parse\");","module.exports = require(\"dotenv\");","module.exports = require(\"fs\");","module.exports = require(\"puppeteer\");"],"sourceRoot":""}